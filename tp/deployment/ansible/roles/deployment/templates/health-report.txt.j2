# ============================================
# TEMPLATE: Rapport de santÃ© dÃ©taillÃ©
# DESCRIPTION: Rapport complet des tests de santÃ©
# ============================================

RAPPORT DE SANTÃ‰ - {{ app_name | upper }}
=========================================

ğŸ“Š **RÃ©sumÃ© ExÃ©cutif**
- Score de santÃ© global: {{ health_score }}%
- Timestamp: {{ ansible_date_time.iso8601 }}
- DurÃ©e des tests: {{ total_duration }}s
- Statut: {{ 'SUCCÃˆS' if health_score|float >= 80 else 'Ã‰CHEC' }}

ğŸ–¥ï¸  **Ressources SystÃ¨me**
- CPU: {{ system_resources.cpu }}%
- MÃ©moire: {{ system_resources.memory }}%
- Disque: {{ system_resources.disk }}%

ğŸ³ **Containers Docker**
- Nombre de containers: {{ containers_count }}
- Statut: Tous en cours d'exÃ©cution
{% for container in containers_info %}
- {{ container.Name }}: {{ container.State }}
{% endfor %}

ğŸŒ **Application Web**
- Port: {{ deployment.app_port | default(3000) }}
- Temps de rÃ©ponse: {{ response_time }}s
- Endpoint santÃ©: âœ… ACCESSIBLE
- Tests fonctionnels: âœ… RÃ‰USSIS

ğŸ—„ï¸  **Base de DonnÃ©es**
- MongoDB: âœ… CONNECTÃ‰E
- Performance: {{ mongo_performance_test.stdout if mongo_performance_test is defined else 'N/A' }}
- Espace stockage: {{ mongo_storage_test.stdout if mongo_storage_test is defined else 'N/A' }}

âš¡ **Tests de Charge (si activÃ©s)**
{% if load_test_success_rate is defined %}
- Taux de succÃ¨s: {{ load_test_success_rate }}%
- RequÃªtes simultanÃ©es: {{ health_checks.load_test.concurrent_requests | default(10) }}
{% else %}
- Tests de charge: NON ACTIVÃ‰S
{% endif %}

ğŸ” **DÃ©tails Techniques**
- Version application: {{ app_version }}
- Environnement: {{ app_environment }}
- StratÃ©gie dÃ©ploiement: {{ deployment.strategy }}
- Image Docker: {{ docker.image_name }}:{{ app_version }}

ğŸ“ˆ **Recommandations**
{% if health_score|float < 70 %}
âš ï¸  CRITIQUE - Score de santÃ© trÃ¨s faible:
- VÃ©rifier immÃ©diatement les logs d'application
- ContrÃ´ler les ressources systÃ¨me
- Envisager un rollback si nÃ©cessaire
{% elif health_score|float < 80 %}
âš ï¸  ATTENTION - Score de santÃ© insuffisant:
- Surveiller les mÃ©triques de prÃ¨s
- Planifier une maintenance prÃ©ventive
- Analyser les goulots d'Ã©tranglement
{% else %}
âœ… EXCELLENT - Application en bonne santÃ©:
- Maintenir la surveillance
- Continuer les bonnes pratiques
- Envisager des optimisations
{% endif %}

ğŸ“ **Contacts d'urgence**
- Ã‰quipe DevOps: {{ notifications.emergency_contact | default('Non configurÃ©') }}
- Slack: {{ notifications.slack.channel | default('Non configurÃ©') }}
- Email: {{ notifications.email.recipients | join(', ') if notifications.email.recipients is defined else 'Non configurÃ©' }}

---
Rapport gÃ©nÃ©rÃ© automatiquement par Ansible
Serveur: {{ ansible_hostname }}
Date: {{ ansible_date_time.iso8601 }}
